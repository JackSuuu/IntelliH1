# ğŸ§  Cognitive Humanoid Framework - é›†æˆè¯´æ˜

## æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ§  LLM Planning Layer                      â”‚
â”‚         Groq API + Llama 3.3 + RAG System              â”‚
â”‚   Natural Language â†’ Target Position & Speed           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ğŸ‘ï¸ Perception Layer                          â”‚
â”‚      LIDAR Simulation + Occupancy Mapping              â”‚
â”‚   Environment â†’ Obstacle Detection â†’ Grid Map          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ğŸ—ºï¸ Path Planning Layer                       â”‚
â”‚        A* Algorithm + Obstacle Avoidance               â”‚
â”‚   Start + Goal + Map â†’ Waypoint Sequence               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ğŸš¶ Motion Control Layer                       â”‚
â”‚     Official Unitree RL Walking Controller             â”‚
â”‚   Waypoints â†’ Velocity Commands â†’ Stable Locomotion    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ® MuJoCo Simulator                        â”‚
â”‚      Unitree H1 Robot + Enhanced Environment           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç»„ä»¶

### 1. CognitiveHumanoidController (ä¸»æ§åˆ¶å™¨)
**ä½ç½®**: `src/control/cognitive_controller.py`

**åŠŸèƒ½**:
- é›†æˆæ‰€æœ‰4ä¸ªå±‚çº§
- ç®¡ç†å¯¼èˆªçŠ¶æ€æœº
- åè°ƒå„æ¨¡å—é€šä¿¡
- å®æ—¶æ›´æ–°æ„ŸçŸ¥å’Œæ§åˆ¶

**ä¸»è¦æ–¹æ³•**:
```python
async def execute_command(command: str) -> Dict
    # Pipeline: LLM â†’ Perception â†’ A* â†’ Motion
    
def update(current_time: float, dt: float) -> Dict
    # æ¯ä¸ªä»¿çœŸæ­¥éª¤è°ƒç”¨ï¼Œæ›´æ–°æ‰€æœ‰å±‚
```

### 2. NavigationPlanner (LLMè§„åˆ’å±‚)
**ä½ç½®**: `src/llm/navigation_planner.py`

**åŠŸèƒ½**:
- è§£æè‡ªç„¶è¯­è¨€å‘½ä»¤
- è°ƒç”¨Groq API (Llama 3.3)
- æ˜ å°„landmarkåˆ°åæ ‡
- ç”Ÿæˆé€Ÿåº¦å»ºè®®

**Landmarks**:
- Kitchen: (5.0, 3.0)
- Bedroom: (-3.0, 6.0)
- Living Room: (0.0, -4.0)
- Center: (0.0, 0.0)

**ç¤ºä¾‹**:
```python
command = "walk to the kitchen"
â†’ LLMè§£æ â†’ {
    "task_type": "navigate",
    "target_position": [5.0, 3.0],
    "speed": 0.6,
    "reasoning": "Navigate to kitchen landmark"
}
```

### 3. AStarPlanner (è·¯å¾„è§„åˆ’å±‚)
**ä½ç½®**: `src/perception/path_planner.py`

**åŠŸèƒ½**:
- ç»´æŠ¤30m x 30må æ®æ …æ ¼åœ°å›¾
- A*ç®—æ³•ç”Ÿæˆå…¨å±€è·¯å¾„
- éšœç¢ç‰©è†¨èƒ€ï¼ˆæœºå™¨äººåŠå¾„: 0.3mï¼‰
- 8è¿é€šç½‘æ ¼ï¼ˆå…è®¸å¯¹è§’çº¿ç§»åŠ¨ï¼‰

**é…ç½®**:
- Grid resolution: 0.3m (30cm per cell)
- Map size: 30m x 30m
- Robot radius: 0.3m (å®‰å…¨è¾¹è·)

### 4. UnitreeRLWalkingController (è¿åŠ¨æ§åˆ¶å±‚)
**ä½ç½®**: `src/control/unitree_rl_controller.py`

**åŠŸèƒ½**:
- å®˜æ–¹é¢„è®­ç»ƒRLç­–ç•¥
- PDæ§åˆ¶è·Ÿè¸ªç›®æ ‡å…³èŠ‚ä½ç½®
- èˆªç‚¹è·Ÿéšä¸å¯¼èˆªæ›´æ–°
- é€Ÿåº¦æ¯”ä¾‹æ§åˆ¶

**æ€§èƒ½**:
- ç¨³å®šè¡Œèµ°: 30+ ç§’
- è¡Œèµ°é€Ÿåº¦: 0.5-1.2 m/s
- é»˜è®¤é€Ÿåº¦: 0.8 m/s (æå‡å)
- æ§åˆ¶é¢‘ç‡: 50Hz (ç­–ç•¥) / 500Hz (ä»¿çœŸ)

## æ•°æ®æµ

### åˆå§‹åŒ–é˜¶æ®µ
```
1. åŠ è½½MuJoCoåœºæ™¯ (scene_enhanced.xml)
2. åˆå§‹åŒ–LLMè§„åˆ’å™¨ (è¿æ¥Groq API)
3. åˆå§‹åŒ–A*è§„åˆ’å™¨ (åˆ›å»ºç©ºç™½åœ°å›¾)
4. åŠ è½½Unitree RLç­–ç•¥ (motion.pt)
5. ç³»ç»Ÿå‡†å¤‡å°±ç»ª
```

### å‘½ä»¤æ‰§è¡Œé˜¶æ®µ
```
ç”¨æˆ·è¾“å…¥: "walk to the kitchen"
    â†“
[LLM Layer] è§£æå‘½ä»¤
    â†’ Target: (5.0, 3.0), Speed: 0.6 m/s
    â†“
[Perception Layer] æ‰«æç¯å¢ƒ
    â†’ LIDAR: 360ä¸ªè·ç¦»é‡‡æ ·
    â†’ æ›´æ–°å æ®æ …æ ¼ï¼ˆæ ‡è®°éšœç¢ç‰©ï¼‰
    â†“
[Path Planning Layer] A*è§„åˆ’
    â†’ èµ·ç‚¹: (0.0, 0.0)
    â†’ ç»ˆç‚¹: (5.0, 3.0)
    â†’ è¾“å‡º: èˆªç‚¹åºåˆ— [(0.15, 0.15), (0.45, 0.45), ...]
    â†“
[Motion Control Layer] è·Ÿéšèˆªç‚¹
    â†’ è®¡ç®—åˆ°å½“å‰èˆªç‚¹çš„è·ç¦»å’Œæ–¹å‘
    â†’ è®¾ç½®é€Ÿåº¦å‘½ä»¤: vx=0.32, vy=0.00, omega=0.50
    â†’ PDæ§åˆ¶è¾“å‡ºå…³èŠ‚åŠ›çŸ©
    â†“
[MuJoCo] ç‰©ç†ä»¿çœŸ
    â†’ åº”ç”¨åŠ›çŸ©åˆ°å…³èŠ‚
    â†’ æ›´æ–°æœºå™¨äººçŠ¶æ€
    â†’ æ¸²æŸ“è§†è§‰åé¦ˆ
```

### å®æ—¶æ›´æ–°å¾ªç¯ (æ¯0.002s)
```
while simulation_running:
    1. cognitive_controller.update(time, dt=0.002)
        â”œâ”€ æ›´æ–°æ„ŸçŸ¥ (æ¯0.5s)
        â”‚   â””â”€ LIDARæ‰«æ + å æ®åœ°å›¾æ›´æ–°
        â”œâ”€ æ£€æŸ¥èˆªç‚¹åˆ°è¾¾
        â”‚   â””â”€ å¦‚æœåˆ°è¾¾ï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªèˆªç‚¹
        â”œâ”€ æ›´æ–°å¯¼èˆª
        â”‚   â””â”€ è®¡ç®—é€Ÿåº¦å‘½ä»¤
        â””â”€ è®¡ç®—å¹¶åº”ç”¨æ§åˆ¶åŠ›çŸ©
    
    2. sim.step()  # MuJoCoä»¿çœŸæ­¥è¿›
    3. viewer.sync()  # æ¸²æŸ“ç”»é¢
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€æµ‹è¯•
```bash
# LLMé©±åŠ¨çš„å¯¼èˆªï¼ˆè‡ªç„¶è¯­è¨€ï¼‰
mjpython src/test/test_llm_navigation.py --command "walk to the kitchen"

# å¯¼èˆªåˆ°å§å®¤
mjpython src/test/test_llm_navigation.py --command "go to the bedroom"

# å¯¼èˆªåˆ°å®¢å…
mjpython src/test/test_llm_navigation.py --command "move to the living room"
```

### é€šè¿‡demo.sh (ç®€åŒ–ç‰ˆæœ¬)
```bash
# å¿«é€Ÿè¡Œèµ°
./demo.sh --walk --walk-speed 0.8

# å¯¼èˆªåˆ°å¨æˆ¿
./demo.sh --navigate --target kitchen

# å¯¼èˆªåˆ°è‡ªå®šä¹‰åæ ‡
./demo.sh --navigate --target 5.0,3.0
```

## æ€§èƒ½æŒ‡æ ‡

### å½“å‰æµ‹è¯•ç»“æœ
- âœ… **LLMè§£æ**: æˆåŠŸç‡ 100% (Groq APIå“åº”æ—¶é—´ < 1s)
- âœ… **A*è§„åˆ’**: è·¯å¾„ç”ŸæˆæˆåŠŸï¼Œè€ƒè™‘éšœç¢ç‰©
- âœ… **èˆªç‚¹è·Ÿéš**: æœºå™¨äººæ­£åœ¨ç¨³å®šè·Ÿéšè·¯å¾„
- âœ… **ç¨³å®šæ€§**: Height 1.00-1.03mï¼Œè¿ç»­ç¨³å®š
- âœ… **é€Ÿåº¦**: å®é™…é€Ÿåº¦ 0.28-0.32 m/s (æ¥è¿‘ç›®æ ‡ 0.6 m/s)

### ä¼˜åŒ–ç©ºé—´
1. **LIDARå®ç°**: å½“å‰æ˜¯æ¨¡æ‹Ÿçš„ï¼Œéœ€è¦é›†æˆMuJoCo raycast
2. **åŠ¨æ€é‡è§„åˆ’**: æ£€æµ‹åˆ°æ–°éšœç¢ç‰©æ—¶é‡æ–°è§„åˆ’è·¯å¾„
3. **é€Ÿåº¦ä¼˜åŒ–**: åœ¨å¼€é˜”åŒºåŸŸæé«˜é€Ÿåº¦ï¼Œéšœç¢ç‰©é™„è¿‘å‡é€Ÿ
4. **è½¬å‘ä¼˜åŒ–**: å½“å‰omegaæ§åˆ¶è¾ƒç®€å•ï¼Œå¯ä»¥ä¼˜åŒ–è½¬å‘ç­–ç•¥
5. **è§†è§‰æ„ŸçŸ¥**: é›†æˆRGB-Dç›¸æœºå’Œç‰©ä½“æ£€æµ‹

## ç¯å¢ƒé…ç½®

### åœºæ™¯å¸ƒå±€ (scene_enhanced.xml)
```
å¨æˆ¿åŒºåŸŸ (ä¸œåŒ—):
  - Kitchen Counter: (5.0, 2.5)
  - Kitchen Cabinet: (5.5, 3.5)
  - Landmarkç›®æ ‡: (5.0, 3.0)

å§å®¤åŒºåŸŸ (è¥¿åŒ—):
  - Bed: (-3.5, 6.0)
  - Nightstand: (-2.0, 6.0)
  - Landmarkç›®æ ‡: (-3.0, 6.0)

å®¢å…åŒºåŸŸ (å—):
  - Couch: (0.0, -4.5)
  - Coffee Table: (0.0, -3.0)
  - Landmarkç›®æ ‡: (0.0, -4.0)

å¯ç§»åŠ¨ç‰©ä½“:
  - Red Cube (freejoint)
  - Green Cube (freejoint)
  - Blue Sphere (freejoint)
```

## ä¾èµ–é¡¹

### PythonåŒ…
```
mujoco >= 3.3.0       # ç‰©ç†ä»¿çœŸ
numpy                 # æ•°å€¼è®¡ç®—
groq                  # LLM APIå®¢æˆ·ç«¯
torch                 # RLç­–ç•¥åŠ è½½
```

### ç¯å¢ƒå˜é‡
```bash
export GROQ_API_KEY="your_api_key_here"
```

## è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### å¯è§†åŒ–å æ®åœ°å›¾
```python
import matplotlib.pyplot as plt
plt.imshow(cognitive_controller.path_planner.grid)
plt.show()
```

### æ£€æŸ¥èˆªç‚¹åºåˆ—
```python
print(f"Path waypoints: {cognitive_controller.current_path}")
print(f"Current waypoint index: {cognitive_controller.path_index}")
```

## æ•…éšœæ’é™¤

### é—®é¢˜: "Goal position is in obstacle!"
**åŸå› **: ç›®æ ‡ç‚¹è¢«éšœç¢ç‰©è†¨èƒ€è¦†ç›–
**è§£å†³**: 
- å‡å° `robot_radius` (å½“å‰: 0.3m)
- è°ƒæ•´é™æ€éšœç¢ç‰©ä½ç½®ï¼Œé¿å…ç²¾ç¡®è¦†ç›–landmark

### é—®é¢˜: "No valid path found"
**åŸå› **: èµ·ç‚¹æˆ–ç»ˆç‚¹æ— æ³•åˆ°è¾¾ï¼Œæˆ–è·¯å¾„è¢«å®Œå…¨é˜»å¡
**è§£å†³**:
- æ£€æŸ¥å æ®åœ°å›¾: `path_planner.grid`
- éªŒè¯éšœç¢ç‰©ä½ç½®æ˜¯å¦åˆç†
- å¢åŠ åœ°å›¾åˆ†è¾¨ç‡æˆ–å‡å°éšœç¢ç‰©è†¨èƒ€

### é—®é¢˜: æœºå™¨äººåŸåœ°æ‰“è½¬
**åŸå› **: èˆªç‚¹è·ç¦»å¤ªè¿‘æˆ–å¯¼èˆªæ›´æ–°é¢‘ç‡é—®é¢˜
**è§£å†³**:
- å¢åŠ  `navigation_tolerance` (å½“å‰: 0.5m)
- æ£€æŸ¥ `update_navigation()` è°ƒç”¨é¢‘ç‡

## ä¸‹ä¸€æ­¥å¼€å‘

### Phase 1: æ„ŸçŸ¥å¢å¼º âœ… (å·²å®Œæˆ)
- [x] LLMå‘½ä»¤è§£æ
- [x] A*è·¯å¾„è§„åˆ’
- [x] èˆªç‚¹è·Ÿéš
- [x] éšœç¢ç‰©åœ°å›¾

### Phase 2: å®æ—¶æ„ŸçŸ¥ (è¿›è¡Œä¸­)
- [ ] MuJoCo raycast LIDAR
- [ ] RGB-Dç›¸æœºé›†æˆ
- [ ] åŠ¨æ€éšœç¢ç‰©æ£€æµ‹
- [ ] å®æ—¶åœ°å›¾æ›´æ–°

### Phase 3: æ™ºèƒ½è§„åˆ’ (è®¡åˆ’ä¸­)
- [ ] åŠ¨æ€é‡è§„åˆ’
- [ ] å¤šç›®æ ‡ä»»åŠ¡åºåˆ—
- [ ] è‡ªé€‚åº”é€Ÿåº¦æ§åˆ¶
- [ ] å­¦ä¹ ç”¨æˆ·åå¥½

### Phase 4: é«˜çº§èƒ½åŠ› (æœªæ¥)
- [ ] ç‰©ä½“æŠ“å–
- [ ] äººæœºåä½œ
- [ ] è¯­éŸ³äº¤äº’
- [ ] é•¿æœŸè®°å¿†

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼é‡ç‚¹æ”¹è¿›æ–¹å‘:
1. å®ç°çœŸå®çš„LIDARæ‰«æ (MuJoCo raycast)
2. ä¼˜åŒ–è·¯å¾„å¹³æ»‘ç®—æ³•
3. é›†æˆåŠ¨æ€éšœç¢ç‰©æ£€æµ‹
4. æ”¹è¿›LLMæç¤ºå·¥ç¨‹
5. æ·»åŠ æ›´å¤šæµ‹è¯•åœºæ™¯

---

**ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-11-10  
**çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å¯ç”¨ï¼Œæ­£åœ¨ä¼˜åŒ–ä¸­
